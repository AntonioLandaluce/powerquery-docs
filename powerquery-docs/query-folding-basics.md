---
title: Query folding basics
description: Understanding the basic principles of query folding to get the most out of your Power Query experience and optimize your queries.
author: ptyx507
ms.service: powerquery
ms.reviewer: 
ms.date: 09/02/2020
ms.author: v-miesco
---
# Query folding basics

Query folding in Power Query is a mechanism where Power Query tries to push as much work as possible to the data source by translating the code generated by Power Query (in the M language) into the native query language of your data source and requesting data from your data source using the translated native query created automatically by the Query folding mechanism. 

Depending on how the query is structured, there could be three (3) possible outcomes for this mechanism:
* **Full Query Folding** - When all of your query transformations get pushed back to the data source and no processing occurs locally by the Power Query engine. Instead you receive your desired output directly from the data source.
* **Partial Query Folding** - When only a few transformations in your query, and not all, can be pushed back to the data source. This means that a subset of your transformations will be performed at your data source and the rest of your query transformations will occur locally.
* **No Query folding** -  When the query contains transformations that can't be translated to the native query langauge of your data source either because the transformations are not supported or the connector doesn't support Query folding. For this case Power Query gets the raw data from your data source and works locally with the Power Query engine to achieve your desired output.

>[!NOTE]
>The Query folding mechanism is primarily available in connectors for structured data sources such as but not limited to [Microsoft SQL Server](Connectors/sqlserver.md) and [OData Feed](Connectors/odatafeed.md). 
>
>Leveraging a data source that has more processing resources and has Query folding capabilities can expedite your query loading times as the prorcessing will occur at the data source and not locally in the Power Query engine.

This article will try to provide some example scenarios for each of the possible outcomes for query folding in the next sections as well as some suggestions on how to get the most out of the Query folding mechanism.

## Full Query folding

**About the Data source**: For this scenario the data that you will be connecting to is Microsoft SQL Server and the sample database is the AdventureWorks in its Data Warehouse version which you can download from the article [AdventureWorks sample database](https://docs.microsoft.com/sql/samples/adventureworks-install-configure).

**Connector to use**: The data source has been identified as a database in Microsoft SQL Server. The connector to be used is the [Microsoft SQL Server Connector](Connectors/SQLServer.md).

**Scenario**: You want to summarize the data inside the *FactInternetSales* table by performing the following transformations:

* Only get the data from September 2012 by filtering the rows on the *OrderDate* column

![Filtering the FactInternetSales table by the OrderDate column for only dates in the month of September 2012](images/me-query-folding-basics-filter-values.png)

>[!NOTE]
> You can read more on how to filter rows by their values from the article [Filter values](filter-values.md).

* Group by the *OrderDate* column and create a new aggregated column using the Sum operation on the *SalesAmount* column. Name this new column *Total Sales Amount*.

![Group by using the OrderDate column and aggregating by the SalesAmount column](images/me-query-folding-basics-group-by.png)

>[!NOTE]
> You can read more on how to use the Group by feature from the article [Grouping or summarizing rows](group-by.md).

* Now with the summarized table at the date level, filter the new *Total Sales Amount* column to only keep rows with values greater than or equal to 15000.

![Filtering the summarized table by the Total Sales Amount column for values greater than or equal to 15000](images/me-query-folding-basics-filter-values-greater-than.png)

One simple way to check if the step in your query can fold back to the data source is to right-click the step and see if the **View Native Query** option is enabled or disabled / greyed out.

![Right-clicking the last step of the query to check the View Native Query option](images/me-query-folding-basics-view-native-query.png)

When you click the **View Native Query** option, a new window will appear called **Native Query** where you'll see the Native Query that Power Query has translated from all the transformations that conform the selected step.

![The Native Query window with the SQL code generated by Power Query](images/me-query-folding-basics-native-query-window.png)


## Partial Query folding

OData

## No Query folding
CSV files

## How to take advantage of Query folding

* Follow the best practices
* Check the "View native queries"
* Run Query diagnostics (and manually interpret the results)